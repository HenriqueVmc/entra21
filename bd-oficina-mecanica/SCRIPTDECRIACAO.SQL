-- SCRIPT DE CRIAÇÃO:

CREATE DATABASE OficinaMecanica;
GO

USE OficinaMecanica;
GO

CREATE TABLE Mecanico(Nome VARCHAR(50) NOT NULL,
			Endereco VARCHAR(100) NOT NULL,
			Celular CHAR(11) NOT NULL,
			CPF CHAR(11) NOT NULL CONSTRAINT UqCPF UNIQUE,
			CREA CHAR(5) NOT NULL CONSTRAINT PK_Mecanico PRIMARY KEY);
GO

CREATE TABLE Veiculo(Placa CHAR(7) NOT NULL CONSTRAINT PK_Veiculo PRIMARY KEY(Placa),
			Marca VARCHAR(30) NOT NULL,
			Modelo VARCHAR(30) NOT NULL,
			Ano INT NOT NULL,
			Renavam CHAR(9) NOT NULL CONSTRAINT UqRenavam UNIQUE);
GO

CREATE TABLE VeiculoPesado(Comprimento DECIMAL(4,2) NOT NULL,
			NumEixos TINYINT NOT NULL,
			PesoToneladas DECIMAL(3,2) NOT NULL);
GO

CREATE TABLE Cliente(Nome VARCHAR(30) NOT NULL,
			Endereco VARCHAR(100) NOT NULL,
			Telefone CHAR(10) NOT NULL,
			CodCliente INT NOT NULL IDENTITY CONSTRAINT PK_Cliente PRIMARY KEY,
			CNH CHAR(11) NOT NULL CONSTRAINT UqCNH UNIQUE);
GO

CREATE TABLE Revisao(CodRevisao INT NOT NULL IDENTITY CONSTRAINT PK_Revisao PRIMARY KEY(CodRevisao),
			DataHoraRevisao DATETIME NOT NULL,
			ValorRevisao MONEY,
			Relatorio VARCHAR(1000),
			TrocaPecas BIT);
GO


ALTER TABLE Veiculo ADD CodCliente INT NOT NULL CONSTRAINT FK_Cliente_Veiculo FOREIGN KEY(CodCliente) REFERENCES Cliente(CodCliente);
GO

ALTER TABLE Revisao ADD Placa CHAR(7) NOT NULL CONSTRAINT FK_Veiculo_Revisao FOREIGN KEY(Placa) REFERENCES Veiculo(Placa);
GO

ALTER TABLE Revisao ADD CREA CHAR(5) NOT NULL CONSTRAINT FK_Mecanico_Revisao FOREIGN KEY(CREA) REFERENCES Mecanico(CREA);
GO

ALTER TABLE Veiculopesado ADD Placa CHAR(7) NOT NULL CONSTRAINT FK_Veiculo_VeiculoPesado FOREIGN KEY(Placa) REFERENCES Veiculo(Placa);
GO

CREATE DATABASE Desconecta;
GO 
 
USE Desconecta;
GO



/*ALTER TABLE Revisao ADD CONSTRAINT PK_Revisao PRIMARY KEY(CodRevisao);
GO*/
/*inserir dados do Cargo

INSERT INTO Cargo (NomeCargo, CodCargo, Salario) VALUES ('PROFESSOR', 1, 5500.50);
GO

-- Alterar dados : o dado da matricula 204 vai ser renomeado para braulio

UPDATE Funcionario SET Nome =  'Braulio'
WHERE Matricula = '204'
GO

--deletar dados da tabela

DELETE FROM Funcionario 
WHERE CodCargo = 5;
GO

-- VISUALIZAR QUAL CARGO RECEBE SALARIO MENOR QUE 5000 REAIS 

SELECT NomeCargo, Salario FROM Cargo
WHERE Salario < 2000.00;
GO

// SELECIONAR NOME DOS FUNCIONARIOS EM ORDEM ALFABETICA
// SELECIONAR TODOS OS CAMPOS DA TABELA CARGO QUE POSSUEM VALORES DE SALARIO ABAIXO DE 2000,00

SELECT Nome FROM Funcionario ORDER BY Nome ASC;
GO

SELECT * FROM Cargo
WHERE Salario <= 3000.00;
GO

// OPERADORES AUXILIARES UTILIZADOS EM CONJUNTO COM WHERE EM CASOS EM QUE A CONSULTA EXIJA MAIS DE UMA CONDIÇÃO
//EXEMPLO: CRIAR UMA CONSULTA QUE ME RETORNE UM FUNCIONARIO CHAMADO DE HENRIQUE QUE POSSUA MATRICULA 5

SELECT Nome, Matricula FROM Funcionario
WHERE Nome = 'Henrique' AND Matricula = 204;
GO

//OPERADOR "OU" NO SQL É ( OR )

SELECT Nome, Matricula FROM Funcionario
WHERE Nome = 'Henrique' OR Matricula = 203;
GO

// CONSULTA QUE RETORNE OS SALARIOS ACIMA DE R$ 1000,00 OU CARGO DE MOTORISTA

SELECT Salario, NomeCargo FROM Cargo
WHERE Salario >1000.00 OR NomeCargo = 'PEDREIRO';
GO

--CREATE TABLE Revisao(
	CodRevisao INT NOT NULL IDENTITY,
	Placa CHAR(7),
	CREA CHAR(5),
	DataHoraRevisao DATETIME NOT NULL,
	ValorRevisao MONEY,
	Relatorio VARCHAR(1000),
	TrocaPecas BIT);
GO


*/